package tms;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

import graph.Graph;
import graph.Node;
import graph.Nodes;
import cre.ComplexRole;
import cre.Credential1;
import cre.Credential2;
import cre.Credential3;
import cre.Credentials;
import cre.Role;
import cre.RoleName;
import cre.Roles;
import cre.TMSPrincipal;

public class DBackwardAlgorithm1 {

	static Credentials cres = new Credentials(); 
	static Roles roles = new Roles();
	public static void main(String[] args) throws IOException{
		// TODO Auto-generated method stub
		//credential1:EOrg.preferred<-EOrg.university.student;
		//credential2:EOrg.university<-ABU.accredited;
		//credential3:ABU.accredited<-StateU;
		//credential4:StateU.student<-RegistrarB.stude                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     nt;
		//credential5:RegistrarB.student<-Alice;
		
		//EOrg.preferred
		/*TMSPrincipal p1 = new TMSPrincipal("EOrg");
		RoleName rn1 = new RoleName("preferred");
		Role r1 = new Role(p1,rn1);
		roles.addRole(r1);
		//EOrg.university
		TMSPrincipal p2 = new TMSPrincipal("EOrg");
		RoleName rn2 = new RoleName("university");
		Role r2 = new Role(p2,rn2);
		roles.addRole(r2);
		//EOrg.university.student
		RoleName rn3 = new RoleName("student");
		ComplexRole cr = new ComplexRole(r2,rn3);
		//credential1:EOrg.preferred<-EOrg.university.student;
		Credential3 c1 = new Credential3(r1,cr);
		//ABU.accredited
		TMSPrincipal p4 = new TMSPrincipal("ABU");
		RoleName rn4 = new RoleName("accredited");
		Role r4 = new Role(p4, rn4);
		roles.addRole(r4);
		//credential2:EOrg.university<-ABU.accredited;
		Credential2 c2 = new Credential2(r2,r4);
		//StateU
		TMSPrincipal p5 = new TMSPrincipal("StateU");
		//credential3:ABU.accredited<-StateU;
		Credential1 c3 = new Credential1(r4,p5);
		//StateU.student
		RoleName rn5 = new RoleName("student");
		Role r5 = new Role(p5,rn5);
		roles.addRole(r5);
		//RegistrarB.student
		TMSPrincipal p6 = new TMSPrincipal("RegistrarB");
		Role r6 = new Role(p6,rn5);
		roles.addRole(r6);
		//credential4:StateU.student<-RegistrarB.student;
		Credential2 c4 = new Credential2(r5,r6);
		//Alice
		TMSPrincipal p7 = new TMSPrincipal("Alice");
		//credential5:RegistrarB.student<-Alice;
		Credential1 c5 = new Credential1(r6,p7);

		
		
		cres.addCredential3(c1);
		cres.addCredential2(c2);
		cres.addCredential1(c3);
		cres.addCredential2(c4);
		cres.addCredential1(c5);*/
		
		/*TMSPrincipal p_a = new TMSPrincipal("A");
		TMSPrincipal p_b = new TMSPrincipal("B");
		TMSPrincipal p_d = new TMSPrincipal("D");
		RoleName rn0 = new RoleName("r0");
		RoleName rn1 = new RoleName("r1");
		RoleName rn2 = new RoleName("r2");
		RoleName rn3 = new RoleName("r3");
		Role r1 = new Role(p_a, rn0);           //A.r0
		Role r2 = new Role(p_a, rn1);           //A.r1
		Role r3 = new Role(p_b, rn1);           //B.r1
		Role r4 = new Role(p_b, rn0);           //B.r0
		Role r5 = new Role(p_d, rn2);           //D.r2
		Role r6 = new Role(p_d, rn1);           //D.r1
		ComplexRole cr1 = new ComplexRole(r2, rn2);              //A.r1.r2
		ComplexRole cr2 = new ComplexRole(r5, rn3);              //D.r2.r3
		
		roles.addRole(r1);
		roles.addRole(r2);
		roles.addRole(r3);
		roles.addRole(r4);
		roles.addRole(r5);
		roles.addRole(r6);
		
		Credential3 c1 = new Credential3(r1, cr1);         
		Credential1 c2 = new Credential1(r1, p_a);
		Credential2 c3 = new Credential2(r2, r3);
		Credential2 c4 = new Credential2(r2, r1);
		Credential2 c5 = new Credential2(r3, r1);
		Credential1 c6 = new Credential1(r3, p_d);
		Credential1 c7 = new Credential1(r5, p_b);
		Credential2 c8 = new Credential2(r4, r1);
		Credential3 c9 = new Credential3(r6, cr2);
		
		cres.addCredential1(c2);
		cres.addCredential1(c6);
		cres.addCredential1(c7);
		cres.addCredential2(c3);
		cres.addCredential2(c4);
		cres.addCredential2(c5);
		cres.addCredential2(c8);
		cres.addCredential3(c1);
		cres.addCredential3(c9);*/
		
		
		//getCredentialInput();
		/*TMSPrincipal p1 = new TMSPrincipal("StateU");
		RoleName rn = new RoleName("student");*/
		TMSPrincipal p1 = new TMSPrincipal("EOrg");
		RoleName rn = new RoleName("preferred");
		Role r = new Role(p1, rn);
		//roles.addRole(r);
		dBackward(r);
	}
	
	public static void dBackward(Role r)
	{
		Graph g = new Graph();
		//g.setCredentials(cres);
		//g.setRoles(roles);
		Node n = g.addNode(r);
		n.b_activate();
		g.run();
		n.printSolutions();
	}
}
